function cp_node_modules
    set DIR (basename $PWD)
    cd $HOME/projects/homebase/main
    set folders (fd -td -p --no-ignore -a -g '**/node_modules' -E '**/node_modules/**/node_modules')
    set -a folders (fd -td -p --no-ignore -a -g '**/dist' -E '*node_modules*' -E '*__mocks__*')
    set -l array
    if type -q fcp
        for folder in $folders
            set dest (string replace main $DIR $folder)
            fcp $folder $dest &
        end
    else
        echo "fcp not installed, using cp. Run `cargo install fcp`"
        for folder in $folders
            set dest (string replace main $DIR $folder)
            cp -a $folder $dest &
        end
    end
    wait
    cd -
end
